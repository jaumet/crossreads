<!DOCTYPE html>
<html lang="en" ng-app="library">
<head>
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<link rel="stylesheet" href="css/main_angularjs-small.css">
		<script src="data/dataDiaries-small.js"></script>
		<script src="data/topicsDummy.js"></script>
</head>
<body>
	<div class="mywapper">
      <div class="myorders">
        <p>Diaries in SVG:</p>
        <ul class="nav nav-pills">
          <li role="presentation" data-toggle="pill" class="active"><a href="#by-page_no">by page_no </a></li>
          <li role="presentation" data-toggle="pill"><a href="#by-kind">by kind</a></li>
        </ul>
      </div>
      <div class="myorders">
        <p>Highlight pages</p>
        <ul class="nav nav-pills">
          <li role="presentation" data-toggle="pill" class="active"><a href="#by-page_no">by page_no</a></li>
          <li role="presentation" data-toggle="pill"><a href="#by-kind">by kind</a></li>
        </ul>
      </div>
      <div style="clear:both;height:30px;"></div>
      <div id="container">
        <div id="grid"></div>
        <div id="detail">www</div>
        <div id="reader">reader</div>
      </div>
	</div>

	<!-- Javascript' guest stars: -->
	<script src="js/jquery-1.11.2.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
  <script>
  $(function(){ 
    // Grid builder
    var c = 0;
    var mycolor = ['#9966cc','#66cccc','#99cc66','#cc6666', 'white'];
    $.each(topicMatrix, function(i, row) {
      $("#grid").append("<div id='"+i+"' class='row'></div>");
      $.each(row, function(j, column) { 
        var coord = getCoordinates(i, j);
        $("#"+i).append("<div id='"+i+"x"+j+"' class='c"+column+"' style=\"left:"+coord[1]+"px;top:"+coord[0]+"px;\"></div>");
        c += 1;
      })
    })
    console.log("TOTAL PAGES= "+c);
    
    // Detail popup
    $(".row div")
      .mouseover(function() {
        var pos = $(this).position();
        var offs = $(this).offset();
        var classBgcolor = $(this).attr("class");
        // FIXME create a function to calculate corrections on top and left depending on the position of the mouse and the size of the screen 
        $("#detail").css("display","block").css("top",pos.top+75+"px").css("left",pos.left+"px").addClass(classBgcolor);
        $(this).css("border","2px solid black");
        
      })
      .mouseout(function() {
        $("#detail").css("display","none");
        $(this).css("border","0");//.css("width","4px").css("height","6px");
      })
      // Reader popup
      .click(function() {
        var classBgcolor = $(this).attr("class");
        $("#reader").css("display","block").addClass(classBgcolor);
      });
      $("#reader").click(function() {
        $("#reader").css("display","none");
      });
      
      
      
    function xx() {
      $(".reader").click(function(){
					  console.log("XXXXX");
					  return d3.selectAll("rect.reader").remove();
		  });
		  }

      function getCoordinates(diaryId, pageNo)  {
        var column = diaryId*5;
        var row = pageNo*7;
        return [column,row];
      }
  });
  </script>
</body>
</html>

